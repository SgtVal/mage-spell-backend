<!DOCTYPE html>


<html lang="en">


<head>


  <meta charset="UTF-8" />


  <meta name="viewport" content="width=device-width, initial-scale=1.0" />


  <title>Mage Arena Voice Casting</title>


  <style>


    body {


      font-family: sans-serif;


      background: #0d0d0d;


      color: white;


      text-align: center;


      padding: 2em;


    }


    h1 {


      color: #ffcc00;


    }


    #listenButton {


      background: #6610f2;


      color: white;


      font-size: 1.5em;


      padding: 1em 2em;


      border: none;


      border-radius: 1em;


      cursor: pointer;


      margin-top: 2em;


    }


    #listenButton:active {


      background: #520dc2;


    }


    #status {


      margin-top: 1em;


      font-size: 1.2em;


      color: #cccccc;


    }


  </style>


</head>


<body>


  <h1>üéôÔ∏è Mage Arena Voice Casting</h1>


  <p>Hold the button and speak your spell (e.g. "fireball")</p>





  <button id="listenButton">üé§ Hold to Cast</button>


  <div id="status">Status: Idle</div>





  <script>


    const playerId = "4279451426"; // Your Roblox UserId ‚Äî make dynamic later if needed


    const backendURL = "https://mage-spell-api.onrender.com";





    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();


    recognition.lang = 'en-US';


    recognition.interimResults = false;





    const button = document.getElementById("listenButton");


    const status = document.getElementById("status");





    button.addEventListener("mousedown", () => {


      status.innerText = "üéß Listening...";


      recognition.start();


    });





    button.addEventListener("mouseup", () => {


      status.innerText = "‚è≥ Processing...";


      recognition.stop();


    });





    // Mobile support for touch


    button.addEventListener("touchstart", () => {


      status.innerText = "üéß Listening...";


      recognition.start();


    });





    button.addEventListener("touchend", () => {


      status.innerText = "‚è≥ Processing...";


      recognition.stop();


    });





    // Optional: keypress (e.g. M key)


    document.addEventListener("keydown", (e) => {


      if (e.key === "m") {


        recognition.start();


        status.innerText = "üéß Listening (M key)...";


      }


    });


    document.addEventListener("keyup", (e) => {


      if (e.key === "m") {


        recognition.stop();


        status.innerText = "‚è≥ Processing...";


      }


    });





    recognition.onresult = (event) => {


      const transcript = event.results[0][0].transcript.toLowerCase();


      status.innerText = "üó£Ô∏è Heard: " + transcript;





      fetch(backendURL + "/cast", {


        method: "POST",


        headers: { "Content-Type": "application/json" },


        body: JSON.stringify({ userId: playerId, spell: transcript })


      })


        .then(() => {


          status.innerText = "‚úÖ Spell Sent: " + transcript;


        })


        .catch(() => {


          status.innerText = "‚ùå Error sending spell";


        });


    };





    recognition.onerror = (event) => {


      status.innerText = "‚ö†Ô∏è Error: " + event.error;


    };


  </script>


</body>


</html>
